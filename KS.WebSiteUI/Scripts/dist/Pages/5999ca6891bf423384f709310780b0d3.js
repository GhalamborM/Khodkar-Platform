$("#i5999ca6891bf423384f709310780b0d3").on($.asEvent.page.loaded,function(n,t,i){var h="#i5999ca6891bf423384f709310780b0d3",tt=".i5999ca6891bf423384f709310780b0d3."+$.asPageClass,r=function(n){var t=new $.as({pageId:tt});return t.as(n)},st=function(){},dt,p,ot;$(h).on($.asEvent.page.dispose,function(){st()});$.asUrls=$.extend({cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId:"/odata/cms/MasterDataKeyValues?$filter=TypeId%20eq%20@typeIdd&$select=Id%2CParentId%2CCode%2CPathOrUrl%2COrder%2CName%2CIsLeaf%2CKey%2CValue",develop_code_browser_bundle_compile:"/develop/code/browser/bundle/compile",develop_code_browser_GetBundlesOfCodeByDefaultsLanguageByPaging:"/odata/cms/MasterDataKeyValues?$filter=(TypeId%20eq%20@typeIdd)%20and%20(ParentId%20eq%20@parentIdd)&$orderby=@orderby&$skip=@skip&$top=@top&$select=Id%2CName%2CCode%2CPathOrUrl%2CKey%2CValue%2CSecondCode%2CDescription%2CViewRoleId%2CAccessRoleId%2CModifyRoleId%2CRowVersion&$inlinecount=allpages",cms_masterDataKeyValue_GetByDefaultsLanguageAndParentTypetId:"/odata/cms/MasterDataKeyValues?$filter=ParentTypeId%20eq%20@parentTypeIdd&$select=Id%2CParentId%2CCode%2COrder%2CName%2CTypeId",develop_code_browser_bundle_save:"/develop/code/browser/bundle/Save",develop_code_browser_bundle_Delete:"/develop/code/browser/bundle/delete",develop_code_browser_GetBundlesOfCodeExceptOneByOneBundle:"/odata/cms/MasterDataKeyValues?$filter=((TypeId%20eq%201033d)%20and%20(ParentId%20eq%20@codeIdd))%20and%20(Value%20ne%201d)&$select=Id%2CParentId%2CPathOrUrl",develop_code_browser_getBundledependency:"/develop/code/browser/getbundledependency/@bundleId"},$.asUrls);var ht=$(tt),ct=r("#frmAddOrAupdate"),it=r("#txtDependencyKey"),w=r("#txtPath"),ti=r("#txtCdnUrl"),rt=r("#txtName"),ut=r("#txtDescription"),l=r("#chkCdn"),e=r("#chkOneByOneBundle"),ii=r("#chkPublishBundle"),ai=r("#btnCancel"),vi=r("#btnSelect"),ri=r("#btnTranslator"),ui=r("#btnEdit"),fi=r("#btnNew"),ei=r("#btnCompile"),oi=r("#btnAddDependency"),b=r("#drpViewRole2"),k=r("#drpModifyRole2"),d=r("#drpAccessRole2"),lt=r("#drpCodeTypeForDependency"),ft=r("#drpCodesDependency"),a=r("#drpBundlesDependency"),u=r("#drpDependency"),si=r("#btnManageSource"),hi=r("#btnSelectPath"),g=r("#btnDell"),o=r("#grvBundles"),at=$.asModalManager.get({url:$.asModalManager.urls.translator}),c=r("#winAddOrEdit"),vt=$.asModalManager.get({url:$.asModalManager.urls.directorySelector}),yt=r("#winBundleSourceManager"),yi=r("#divRoles"),et=r("#divCdn"),ci=r("#divDependency"),v=r("#divDependencyPanel"),pt=!0,wt,f=!1,bt,y={items:{}},kt='<div class="as-material-switch container-fluid @class"><div><input name="chkCdn" type="checkbox" @IsCdn /><label class="label-default as-label" for="chkCdn" >  <\/label><\/div><\/div>',nt="";if(et.hide(),c.asModal({backdrop:"static",keyboard:!1}),at.asModal({width:800}),vt.asModal({width:800}),yt.asModal({width:800}),dt={txtCdnUrl:{required:{depends:function(n){return $(n).is(":visible")}},maxlength:1024},txtDependencyKey:{required:{depends:function(){return gt().length>0}}},txtName:{required:!0,maxlength:255},txtPath:{required:!0,maxlength:1024},txtDescription:{maxlength:256},drpViewRole:{asType:"asDropdown",required:!0},drpAccessRole:{asType:"asDropdown",required:!0},drpModifyRole:{asType:"asDropdown",required:!0}},wt=ct.asValidate({rules:dt}),p=function(n){if(n===null)bt="/",w.val(bt),rt.val(""),ut.val(""),it.val(""),l.prop("checked",!1),e.prop("checked",!1),v.show(),b.asDropdown("selectValue",i.viewRoleId),d.asDropdown("selectValue",i.accessRoleId),k.asDropdown("selectValue",i.modifyRoleId);else{var t=s();w.val(n.PathOrUrl);it.val(n.Code==="bundle_"+t[0].Id?"":n.Code);rt.val(n.Name);ut.val(n.Description);l.prop("checked",n.IsCdn);e.prop("checked",n.OneByOneBundle);n.OneByOneBundle?v.hide():v.show();b.asDropdown("selectValue",n.ViewRoleId);d.asDropdown("selectValue",n.AccessRoleId);k.asDropdown("selectValue",n.ModifyRoleId)}},ot=function(n,t){n.type==="selected"?y.items[t[0].Id]={Id:t[0].Id,Key:t[0].Key,Value:t[0].Value,Name:t[0].Name,Code:t[0].Code,SecondCode:t[0].SecondCode,Description:t[0].Description,PathOrUrl:t[0].PathOrUrl,RowVersion:t[0].RowVersion,ViewRoleId:t[0].ViewRoleId,AccessRoleId:t[0].AccessRoleId,ModifyRoleId:t[0].ModifyRoleId}:delete y.items[t[0].Id]},i){nt=i.codeId;b.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:i.roles}});d.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:i.roles}});k.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:i.roles}});p(null);o.asBootGrid({rowCount:[10,25,50,100],source:{url:""},requestHandler:function(n){if(nt!==""){var t="Name desc",i=0;return n.current>1&&(i=(n.current-1)*n.rowCount),$.each(n.sort,function(n,i){t=n+" "+i}),n.url=$.asInitService($.asUrls.develop_code_browser_GetBundlesOfCodeByDefaultsLanguageByPaging,[{name:"@typeId",value:1033},{name:"@parentId",value:nt},{name:"@top",value:n.rowCount},{name:"@skip",value:i},{name:"@orderby",value:t}]),y.items={},n}},formatters:{IsCdn:function(n,t){return t.Key===1?kt.replace("@IsCdn",'checked="checked"').replace("@class","ltr-text"):kt.replace("@IsCdn","").replace("@class","")}},selection:!0,rowSelect:!0}).on("selected.rs.jquery.asBootGrid",function(n,t){ot(n,t)}).on("deselected.rs.jquery.asBootGrid",function(n,t){ot(n,t)})}var gt=function(){if(a.asDropdown("selected")){var n=[];return $.each(u.asDropdown("selected"),function(t,i){i.selected&&n.push(i.value)}),n}return[]},s=function(){var n=[];return $.each(y.items,function(t,i){n.push(i)}),n},ni=function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration});y.items={};o.asBootGrid("deselect");c.asModal("hide")},li=function(){$(h).on($.asEvent.modal.reopen,function(n,t){t.codeId!==i.codeId&&(i=t,nt=i.codeId,p(null),o.asBootGrid("reload"))});$(h).on($.asEvent.page.ready,function(){});$(h).on("pathSelected",function(n,t){w.val(t.toLowerCase().replace(new RegExp(t.toLowerCase().indexOf($.asDebugBaceStyleUrl.toLowerCase())>-1?$.asDebugBaceStyleUrl.toLowerCase():$.asDebugBaceScriptUrl.toLowerCase(),"gi"),""))});ri.click(function(){var n=s();n.length===1?at.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.translator)},{name:"@isModal",value:!0}]),{type:"masterDataKeyValue",id:n[0].Id,name:n[0].Name,description:n[0].Description}):$.asShowMessage({template:"error",message:"   باید یک bundle انتخاب شود"})});var t=function(n){return $.asAjaxTask({url:n})},n=function(n){pt&&(pt=!1,lt.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndParentTypetId,[{name:"@parentTypeId",value:1028}]),displayDataField:"Name",valueDataField:"TypeId",orderby:"Order"}}),ft.asDropdown("init","نوع کد را انتخاب نمایید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},displayDataField:"Name",valueDataField:"Id",orderby:"Order"},selectParents:!0}),a.asDropdown("init","کد را انتخاب کنید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},displayDataField:"PathOrUrl",valueDataField:"Id",orderby:"PathOrUrl"}}),u.asDropdown("init"," ",{source:{displayDataField:"path",valueDataField:"id",orderby:"path"},multiple:!0}));n&&f===!1&&ci.asAfterTasks([t($.asInitService($.asUrls.develop_code_browser_getBundledependency,[{name:"@bundleId",value:n[0].Id}]))],function(n){var t=[];$.each(n,function(n,i){t.push(i.id)});u.asDropdown({source:{localData:n,displayDataField:"path",valueDataField:"id",orderby:"path"},multiple:!0});u.asDropdown("selectValue",t)},{overlayClass:"as-overlay-absolute-no-height"})};ui.click(function(){var t=s();t.length===1?(f=!1,p({Code:t[0].Code,PathOrUrl:t[0].PathOrUrl,Name:t[0].Name,Description:t[0].Description,IsCdn:t[0].Key===1,OneByOneBundle:t[0].Value===1,RowVersion:t[0].RowVersion,ViewRoleId:i.viewRoleId,AccessRoleId:i.accessRoleId,ModifyRoleId:i.modifyRoleId}),c.asModal("show"),n(t)):$.asShowMessage({template:"error",message:"   باید یک bundle انتخاب شود"})});fi.click(function(){f=!0;p(null);u.asDropdown("selectValue",[],!0);c.asModal("show");n()});e.change(function(){this.checked?v.hide():v.show()});r("#btnExecute").click(function(){if(e.is(":checked")&&l.is(":checked")){$.asShowMessage({template:"error",message:"   یک باندل همزمان نمی تواند تک به تک و مورد استفاده در وابستگی ها باشد"});return}var n=s();c.asAjax({url:$.asUrls.develop_code_browser_bundle_save,data:JSON.stringify({Id:f===!0?0:n[0].Id,ParentId:i.codeId,TypeId:1033,ParentTypeId:"",IsPath:!0,PathOrUrl:w.val(),SecondPathOrUrl:ti.val(),ViewRoleId:b.asDropdown("selected").value,ModifyRoleId:k.asDropdown("selected").value,AccessRoleId:d.asDropdown("selected").value,Name:rt.val(),Description:ut.val(),Key:l.is(":checked")?1:0,Value:e.is(":checked")?1:0,Status:!0,EnableCache:!1,EditMode:!1,IsLeaf:!0,IsType:!1,IsNew:f,DependencyKey:e.is(":checked")?"":it.val(),Dependency:e.is(":checked")?[]:gt(),RowVersion:f===!0?"":n[0].RowVersion}),success:function(n){f===!0?f=!1:o.asBootGrid("remove");o.asBootGrid("append",[n]);ni()}},{$form:ct,overlayClass:"as-overlay-absolute"})});oi.click(function(){if(a.asDropdown("selected")){var r=!0,n=a.asDropdown("selected"),t=[],i=[];u.asDropdown("selected")&&$.each(u.asDropdown("selected"),function(u,f){f.selected&&(f.value===n.value&&(r=!1),i.push(f.value),t.push({id:f.value,path:f.text}))});r&&(t.push({id:n.value,path:n.text}),i.push(n.value));u.asDropdown("reload",{localData:t});u.asDropdown("selectValue",i)}else $.asShowMessage({template:"error",message:"   باید یک bundle انتخاب شود"})});r("#btnCancel").click(function(){c.asModal("hide")});hi.click(function(){vt.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.directorySelector)},{name:"@isModal",value:!0}]),{path:i.codeType==="js"?$.asDebugBaceScriptUrl:$.asDebugBaceStyleUrl,parent:h,event:"pathSelected"})});si.click(function(){var n=s();n.length===1?yt.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter("fa/admin/develop/codes/browsers/bundle/sources")},{name:"@isModal",value:!0}]),{bundleId:n[0].Id,codePath:i.codePath,roles:i.roles,accessRoleId:i.accessRoleId,modifyRoleId:i.modifyRoleId,viewRoleId:i.viewRoleId,parent:h}):$.asShowMessage({template:"error",message:"   باید یک bundle انتخاب شود"})});g.click(function(){var n=s();n.length===1?(ht.asAjax({url:$.asUrls.develop_code_browser_bundle_Delete,data:JSON.stringify({Id:n[0].Id}),error:function(){g.button("reset")},success:function(){g.button("reset");o.asBootGrid("remove");ni()}},{validate:!1,overlayClass:"as-overlay-absolute"}),g.button("loading")):$.asShowMessage({template:"error",message:"   باید یک bundle انتخاب شود"})});lt.on("change",function(n,t){ft.asDropdown("reload",{url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,[{name:"@typeId",value:t.value}])})});ft.on("change",function(n,t){a.asDropdown("reload",{url:$.asInitService($.asUrls.develop_code_browser_GetBundlesOfCodeExceptOneByOneBundle,[{name:"@codeId",value:t.value}])})});l.change(function(){this.checked===!0?et.show():et.hide()});ei.click(function(){var n=s();n.length===1?ht.asAjax({url:$.asUrls.develop_code_browser_bundle_compile,data:JSON.stringify({Id:n[0].Id,IsPublish:ii.is(":checked")}),success:function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{validate:!1,overlayClass:"as-overlay-absolute"}):$.asShowMessage({template:"error",message:"   باید یک bundle انتخاب شود"})});st=function(){o.asBootGrid("destroy");wt.destroy()}};li();$(tt).append('<span id="asRegisterPage"><\/span>');r("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})