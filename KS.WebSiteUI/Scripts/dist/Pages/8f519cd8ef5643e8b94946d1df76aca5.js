$("#i8f519cd8ef5643e8b94946d1df76aca5").on($.asEvent.page.loaded,function(n,t){var f="#i8f519cd8ef5643e8b94946d1df76aca5",ni=".i8f519cd8ef5643e8b94946d1df76aca5."+$.asPageClass,i=function(n){var t=new $.as({pageId:ni});return t.as(n)},ti=function(){},yi;$(f).on($.asEvent.page.dispose,function(){ti()});$.asUrls=$.extend({cms_masterDataKeyValue_GetByOtherLanguagesAndTypeId:"/odata/cms/MasterDataLocalKeyValues?$filter=(MasterDataKeyValue%2FTypeId%20eq%20@typeIdd)%20and%20(Language%20eq%20'@lang')&$expand=MasterDataKeyValue&$select=MasterDataKeyValue%2FId%2CMasterDataKeyValue%2FParentId%2CMasterDataKeyValue%2FCode%2CMasterDataKeyValue%2FOrder%2CMasterDataKeyValue%2FName%2CMasterDataKeyValue%2FKey%2CMasterDataKeyValue%2FValue%2CMasterDataKeyValue%2FIsLeaf%2CMasterDataKeyValue%2FPathOrUrl%2CName",fms_GetFileAndFoldersOfPathByPaging:"/fms/GetByPagination/@path/@orderby/@skip/@take/@createThumbnail",fms_move:"/fms/move",fms_copy:"/fms/copy",fms_zip_openByPaging:"/fms/openzip/@zipFullName/@orderBy/@skip/@take",fms_zip_extract:"/fms/unzip",fms_zip_addOrUpdate:"/fms/zip/add-update",fms_rename:"/fms/rename",fms_delete:"/fms/delete",fms_createDir:"/fms/createdir",fms_get:"/fms/Get/@path",fms_save:"/fms/save"},$.asUrls);var ot=i("#frmZip"),d=i("#frmAction"),di=i("#btnFolderSelector"),ii=$.asModalManager.get({url:$.asModalManager.urls.fileSelector}),st=$.asModalManager.get({url:$.asModalManager.urls.directorySelector}),ht=$.asModalManager.get({url:$.asModalManager.urls.fileAddOrUpdate}),ri=$.asModalManager.get({url:$.asModalManager.urls.remoteDownloadManager}),ui=$.asModalManager.get({url:$.asModalManager.urls.uploadManager}),o=i("#winAction"),c=i("#winZipOption"),fi=i("#winZipViewer"),u=i("#drpPath"),ct=i("#drpCompression"),lt=i("#drpReplace"),at=i("#drpEncryption"),l=i("#txtNameZip"),vt=i("#txtNameZipDir"),yt=i("#txtPassword"),w=i("#txtName"),gi=i("#btnUploadFromUrl"),e=i("#grvFile"),g=i("#divPath"),a=i("#btnMove"),nr=i("#btnCopyByReplace"),pt=i("#btnCopyMain"),tr=i("#btnCopy"),dr=i("#btnZip"),ir=i("#btnZipView"),rr=i("#btnZipAddOrUpdate"),ur=i("#btnUnZip"),v=i("#btnSelectZip"),nt=i("#btnDell"),fr=i("#btnAddOrUpdateFile"),er=i("#chkTumbnail"),or=i("#btnRename"),sr=i("#btnExecute"),hr=i("#btnSelectZipDir"),cr=i("#btnExecAction"),lr=i("#btnCancelAction"),ar=i("#btnCreateDir"),ei=i("#lblNameZipDir"),y=i("#chkNew"),vr=i("#chkReplaceZip"),b=i("#divZipDir"),tt=i("#divReplace"),yr=i("#btnUploadFromDisk"),gr=i("#txtFileName"),nu=i("#txtFileContent"),oi,wt="",s=[],it=0,rt,ut,bt=!1,r={hasFolder:function(){var n=!1;return $.each(this.items,function(t,i){i===!0&&(n=!0)}),n},path:"",items:{}},k=!1,h="move",ft="zip",et="add",si="OverwriteSilently",h="rename",hi="PkzipWeak",ci="Default",li,ai,p="",kt=!1,dt=0,vi=function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration});r.items={}},pr={txtNameZip:{required:!0},txtNameZipDir:{required:{depends:function(n){return $(n).is(":visible")}}}};li=ot.asValidate({rules:pr});yi={txtName:{required:!0}};ai=d.asValidate({rules:yi});c.asModal({backdrop:"static",keyboard:!1});o.asModal({backdrop:"static",keyboard:!1});ii.asModal({width:800});fi.asModal({width:800});st.asModal({width:800});ht.asModal({width:800});ri.asModal({width:800});ui.asModal({width:800});u.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"MasterDataKeyValue.Id"},parentDataField:{name:"MasterDataKeyValue.ParentId"},removeChildLessParent:!1},url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByOtherLanguagesAndTypeId,[{name:"@typeId",value:1025},{name:"@lang",value:$.asLang}]),displayDataField:"Name",valueDataField:"MasterDataKeyValue.PathOrUrl",orderby:"MasterDataKeyValue.Order"},selectParents:!0,parentMode:"uniq"});var gt=function(n){h=n;u.asDropdown("selected")?st.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.directorySelector)},{name:"@isModal",value:!0}]),{path:u.asDropdown("selected").value,parent:f,event:"folderSelected"}):$.asShowMessage({template:"error",message:"No Path Selected"})},wr=function(n,t){a.button("loading");a.asAjax({url:$.asUrls.fms_move,data:JSON.stringify({SourcePath:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"),DestinationPath:wt,Files:n,Folders:t}),success:function(){e.asBootGrid("remove");a.button("reset");vi()},error:function(){a.button("reset")}},{validate:!1})},pi=function(n,t,i){pt.button("loading");a.asAjax({url:$.asUrls.fms_copy,data:JSON.stringify({SourcePath:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"),DestinationPath:wt,Files:n,Folders:t,OverWrite:i}),success:function(){pt.button("reset");$.asShowMessage({message:$.asRes[$.asLang].successOpration})},error:function(){pt.button("reset")}},{validate:!1})},wi=function(){it++;bt=!0;e.asBootGrid("reload")},br=function(){g.empty();it=$(this).data("index");ut=rt;for(var n=0;n<=s.length-1;n++)n<=it&&s[n]!==null?bi(n,s[n]):s[n]=null;wi()},bi=function(n,t){var i=$("<span  data-index='"+n+"' style='font-weight: bold;cursor: pointer;'>"+t+"<\/span> > ");g.append(i);i.click(br);ut+="/"+t},ki=function(n,t){n.type==="selected"?r.items[t[0].Name]=t[0].IsFolder:delete r.items[t[0].Name]},kr=function(){ct.asDropdown({source:{localData:[{Name:"Level1",id:1},{Name:"Level2",id:2},{Name:"Level3",id:3},{Name:"Level4",id:4},{Name:"Level5",id:5},{Name:"Level6",id:6},{Name:"Level7",id:7},{Name:"Level8",id:8},{Name:"Level9",id:9},{Name:"BestCompression",id:10},{Name:"BestSpeed",id:11},{Name:"Default",id:12},{Name:"None",id:13}],displayDataField:"Name",valueDataField:"Name",orderby:"Name"}});ct.asDropdown("selectValue","Default");lt.asDropdown({source:{localData:[{Name:"OverwriteSilently",id:1},{Name:"DoNotOverwrite",id:2},{Name:"Throw",id:3}],displayDataField:"Name",valueDataField:"Name",orderby:"Name"}});lt.asDropdown("selectValue","OverwriteSilently");at.asDropdown({source:{localData:[{Name:"PkzipWeak",id:1},{Name:"WinZipAes128",id:2},{Name:"WinZipAes256",id:3},{Name:"None",id:4}],displayDataField:"Name",valueDataField:"Name",orderby:"Name"}});at.asDropdown("selectValue","PkzipWeak");$(f).on("folderZipSelected",function(n,t){vt.val(t)});$(f).on("folderSelected",function(n,t){wt=t;var i=[],u=[];$.each(r.items,function(n,t){t?u.push(n):i.push(n)});h==="move"?wr(i,u):h==="copy"?pi(i,u,!1):h==="copyByReplace"&&pi(i,u,!0)});$(f).on("zipSelected",function(n,t){l.val(t)});$(f).on($.asEvent.page.ready,function(){e.asBootGrid({caseSensitive:!1,rowCount:[10,25,50,100],source:{url:""},requestHandler:function(n){var t,i,f;return u.asDropdown("selected")?(r.items={},r.path="",t="",bt?t=ut.replace(/\//g,$.asUrlDelimeter):(rt=oi,t=rt.replace(/\//g,$.asUrlDelimeter)),r.path=t,i="Name desc",f=0,n.current>1&&(f=(n.current-1)*n.rowCount),$.each(n.sort,function(n,t){i=n+" "+t}),n.url=$.asInitService($.asUrls.fms_GetFileAndFoldersOfPathByPaging,[{name:"@path",value:t},{name:"@orderby",value:i},{name:"@skip",value:f},{name:"@take",value:n.rowCount},{name:"@createThumbnail",value:er.is(":checked")}]),r.items={},e.asBootGrid("deselect"),n):null},formatters:{Name:function(n,t){return t.IsFolder?"<span class='folder-link' data-row='"+JSON.stringify(t)+"' style='font-weight: bold;cursor: pointer;'><i class='glyphicon glyphicon-folder-open'><\/i> &nbsp;"+t.Name+"<\/span>":"<span><i class='glyphicon glyphicon-file'><\/i> &nbsp;"+t.Name+"<\/span>"}},selection:!0,rowSelect:!0,multiSelect:!0}).on("selected.rs.jquery.asBootGrid",function(n,t){k===!1?ki(n,t):k=!1}).on("deselected.rs.jquery.asBootGrid",function(n,t){k===!1?ki(n,t):k=!1}).on("loaded.rs.jquery.asBootGrid",function(){dt=e.asBootGrid("getTotalRowCount");$(".folder-link").click(function(){var n,t;k=!0;n=$(this).data("row");n.IsFolder&&(t=$.inArray(n.Name,s),t===-1&&(s[it]=n.Name,g.empty(),ut=rt,$.each(s,function(n,t){t!==null&&bi(n,t)}),wi()))})})});u.on("change",function(n,t){for(var i=0;i<=s.length-1;i++)s[i]=null;oi=t.value;g.empty();bt=!1;e.asBootGrid("reload")});v.click(function(){u.asDropdown("selected")?ii.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.fileSelector)},{name:"@isModal",value:!0}]),{path:u.asDropdown("selected").value,parent:f,event:"zipSelected"}):$.asShowMessage({template:"error",message:"No Path Selected"})});$(f).on("fileAdded",function(n,t){e.asBootGrid("append",[{Id:++dt,Name:t.name,IsFolder:!1,Size:0,ModifieLocalDateTime:t.modifieLocalDateTime}])});yr.click(function(){u.asDropdown("selected")?ui.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.uploadManager)},{name:"@isModal",value:!0}]),{path:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/")}):$.asShowMessage({template:"error",message:"No Path Selected  "})});fr.click(function(){var n=[],t=[];$.each(r.items,function(i,r){r?t.push(i):n.push(i)});n.length===0&&u.asDropdown("selected")?(et="add",ht.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.fileAddOrUpdate)},{name:"@isModal",value:!0}]),{fileActionMode:et,parent:f,event:"fileAdded",path:r.path})):n.length===1?u.asDropdown("selected")?(et="update",ht.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.fileAddOrUpdate)},{name:"@isModal",value:!0}]),{files:n,fileActionMode:et,path:r.path})):$.asShowMessage({template:"error",message:"No Path Selected"}):$.asShowMessage({template:"error",message:"One File Must be Selected For Edit"})});hr.click(function(){u.asDropdown("selected")?st.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.directorySelector)},{name:"@isModal",value:!0}]),{path:u.asDropdown("selected").value,parent:f,event:"folderZipSelected"}):$.asShowMessage({template:"error",message:"No Path Selected"})});di.click(function(){});a.click(function(){gt("move")});tr.click(function(){gt("copy")});nr.click(function(){gt("copyByReplace")});ar.click(function(){h="createDir";o.find(".modal-title").text("Create Directory");w.val("");o.asModal("show")});or.click(function(){h="rename";p="";var n=[],t=[];$.each(r.items,function(i,r){r?t.push(i):n.push(i)});n.length===1&&t.length==0?(p=n[0],kt=!1):t.length===1&&n.length==0?(p=t[0],kt=!0):$.asShowMessage({template:"error",message:"To rename, just select a file or a directory"});p!==""&&(w.val(p),o.find(".modal-title").text("Rename"),o.asModal("show"))});lr.click(function(){o.asModal("hide")});rr.click(function(){ft="zip";i(".unzip").hide();i(".zip").show();ei.html("The path to create a new zip");l.val("");y.is(":checked")?(b.show(),v.hide(),tt.show()):(b.hide(),v.show(),tt.hide());c.asModal("show")});ur.click(function(){ft="unzip";i(".zip").hide();i(".unzip").show();b.show();v.show();yt.val();l.val("");ei.html("UnZip Path");c.asModal("show")});nt.click(function(){var n=[],t=[];$.each(r.items,function(i,r){r?t.push(i):n.push(i)});n.length>0||t.length>0?(nt.button("loading"),o.asAjax({url:$.asUrls.fms_delete,data:JSON.stringify({Path:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"),Files:n,Folders:t}),success:function(){nt.button("reset");e.asBootGrid("remove");vi()},error:function(){nt.button("reset")}},{$form:d,overlayClass:"as-overlay-absolute"})):$.asShowMessage({template:"error",message:"The file or directory is not selected for deletion"})});cr.click(function(){h==="rename"?o.asAjax({url:$.asUrls.fms_rename,data:JSON.stringify({OldPath:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/")+"/"+p,NewPath:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/")+"/"+w.val(),IsDirectory:kt}),success:function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:d,overlayClass:"as-overlay-absolute"}):o.asAjax({url:$.asUrls.fms_createDir,data:JSON.stringify({path:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/")+"/"+w.val()}),success:function(n){e.asBootGrid("append",[{Id:++dt,Name:w.val(),IsFolder:!0,Size:0,ModifieLocalDateTime:n}]);$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:d,overlayClass:"as-overlay-absolute"})});ir.click(function(){var n=[];$.each(r.items,function(t,i){i||n.push(t)});n.length===1?fi.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter("en/admin/fms/zip-view/")},{name:"@isModal",value:!0}]),{zipFullName:r.path+"@"+n[0]}):$.asShowMessage({template:"error",message:"Just select a zip file to view"})});y.change(function(){this.checked===!0?(b.show(),v.hide(),tt.show()):(b.hide(),v.show(),tt.hide())});i("#btnCancelZip").click(function(){c.asModal("hide");y.prop("checked",!1)});sr.click(function(){if(ft==="zip"){var n=[],t=[];$.each(r.items,function(i,r){r?t.push(i):n.push(i)});c.asAjax({url:$.asUrls.fms_zip_addOrUpdate,data:JSON.stringify({SourcePath:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"),DestinationPath:y.is(":checked")?vt.val()+"/"+l.val().replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"):l.val().replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"),Files:n,Folders:t,OverWrite:y.is(":checked")?vr.is(":checked"):!0,Encryption:hi,Password:yt.val(),CompressionLevel:ci,IsNew:y.is(":checked")}),success:function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:ot,overlayClass:"as-overlay-absolute"})}else ft==="unzip"&&c.asAjax({url:$.asUrls.fms_zip_extract,data:JSON.stringify({SourcePath:l.val().replace(new RegExp($.asUrlDelimeter,"gi"),"/").replace(new RegExp("//","gi"),"/"),DestinationPath:vt.val(),Password:yt.val(),OverWrite:si}),success:function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:ot,overlayClass:"as-overlay-absolute"})});ct.on("change",function(n,t){t&&(ci=t.value)});lt.on("change",function(n,t){t&&(si=t.value)});at.on("change",function(n,t){t&&(hi=t.value)});gi.click(function(){u.asDropdown("selected")?ri.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.remoteDownloadManager)},{name:"@isModal",value:!0}]),{urlTypeId:1047,path:r.path.replace(new RegExp($.asUrlDelimeter,"gi"),"/")}):$.asShowMessage({template:"error",message:"No Path selected"})});ti=function(){e.asBootGrid("destroy");li.destroy();ai.destroy()}};kr();$(ni).append('<span id="asRegisterPage"><\/span>');i("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})