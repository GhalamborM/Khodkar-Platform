$("#ic47c99d0cb3d4acf8fef3b771b4cab34").on($.asEvent.page.loaded,function(n,t){var o="#ic47c99d0cb3d4acf8fef3b771b4cab34",g=".ic47c99d0cb3d4acf8fef3b771b4cab34."+$.asPageClass,i=function(n){var t=new $.as({pageId:g});return t.as(n)},nt=function(){},st,ht;$(o).on($.asEvent.page.dispose,function(){nt()});$.asUrls=$.extend({cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId:"/odata/cms/MasterDataKeyValues?$filter=TypeId%20eq%20@typeIdd&$select=Id%2CParentId%2CCode%2CPathOrUrl%2COrder%2CName%2CIsLeaf%2CKey%2CValue",security_Role_getAllByDefaultsLanguage:"/odata/security/Roles?$select=Id%2CParentId%2CName%2COrder%2CIsLeaf%2CDescription",cms_file_getByDefaultsLanguagesAndTypeCodeByPaging:"/odata/cms/Files?$filter=TypeCode%20eq%20@typeCoded&$orderby=@orderby&$skip=@skip&$top=@top&$select=Id%2CName%2CDescription%2CTypeCode%2CSize%2CStatus&$inlinecount=allpages",cms_file_save:"/cms/file/Save",cms_file_delete:"/cms/file/delete",cms_file_getById:"/odata/cms/Files?$filter=Id%20eq%20@idd&$select=Id%2CName%2CDescription%2CUrl%2CGuid%2CStatus%2CSize%2CViewRoleId%2CTypeCode%2CAccessRoleId%2CModifyRoleId%2CRowVersion"},$.asUrls);var tt=i("#frm"),it=$.asModalManager.get({url:$.asModalManager.urls.fileSelector}),f=i("#winAddOrEdit"),rt=$.asModalManager.get({url:$.asModalManager.urls.translator}),s=i("#drpPath"),h=i("#drpFileType"),c=i("#txtName"),l=i("#txtPath"),a=i("#txtDescription"),b=i("#txtGuId"),r=i("#grvFile"),lt=i("#btnNew"),dt=i("#btnTranslator"),at=i("#btnEdit"),vt=i("#btnSelectFile"),e=i("#btnDell"),yt=i("#btnExecute"),ut=i("#chkStatus"),pt=i("#divRoles"),ft=i("#divGuid"),v=i("#drpViewRole"),y=i("#drpModifyRole"),p=i("#drpAccessRole"),w=i("#drpFileTypeAddUpdate"),u={hasFolder:function(){var n=!1;return $.each(this.items,function(t,i){i===!0&&(n=!0)}),n},path:"",items:{}},k=0,d="",et='<div class="as-material-switch container-fluid @class"><div><input name="chkStatusGrid" type="checkbox" @status /><label class="label-default as-label" for="chkStatusGrid" >  <\/label><\/div><\/div>',ot,wt=function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration});u.items={};r.asBootGrid("deselect")},bt={drpFileTypeAddUpdate:{asType:"asDropdown",required:!0},drpViewRole:{asType:"asDropdown",required:!0},drpAccessRole:{asType:"asDropdown",required:!0},drpModifyRole:{asType:"asDropdown",required:!0},txtName:{required:!0},txtPath:{required:!0},txtGuId:{required:{depends:function(n){return $(n).is(":visible")}}}};ot=tt.asValidate({rules:bt});rt.asModal({width:800});f.asModal({backdrop:"static",keyboard:!1});it.asModal({width:800});st=function(){return $.asAjaxTask({url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,[{name:"@typeId",value:1009}])})};i("#divFileType").asAfterTasks([st()],function(n){h.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},localData:n,displayDataField:"Name",valueDataField:"Code",orderby:"Order"},selectParents:!0,parentMode:"uniq"});w.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},localData:n,displayDataField:"Name",valueDataField:"Code",orderby:"Order"},selectParents:!0,parentMode:"uniq"})},{overlayClass:"as-overlay-relative"});s.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,[{name:"@typeId",value:1025}]),displayDataField:"Name",valueDataField:"PathOrUrl",orderby:"Order"},selectParents:!0,parentMode:"uniq"});ht=function(){return $.asAjaxTask({url:$.asUrls.security_Role_getAllByDefaultsLanguage})};pt.asAfterTasks([ht()],function(n){v.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}});p.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}});y.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}})},{overlayClass:"as-overlay-relative"});var gt=function(){r.asBootGrid("reload")},ct=function(n,t){n.type==="selected"?u.items[t[0].Name]=t[0].Id:delete u.items[t[0].Name]},kt=function(){var t=function(){$.asNotFound(" فایل")},g=function(n){var t=n[0];k=t.Id;t.Url!==null?l.val(t.Url):l.val("");t.Name!==null?c.val(t.Name):c.val("");t.Description!==null?a.val(t.Description):a.val("");t.Guid!==null?b.val(t.Guid):b.val("");ut.prop("checked",t.Status);t.TypeCode!==null?w.asDropdown("selectValue",t.TypeCode):w.asDropdown("selectValue",[],!0);t.ViewRoleId!==null?v.asDropdown("selectValue",t.ViewRoleId):v.asDropdown("selectValue",[],!0);t.AccessRoleId!==null?p.asDropdown("selectValue",t.AccessRoleId):p.asDropdown("selectValue",[],!0);t.ModifyRoleId!==null?y.asDropdown("selectValue",t.ModifyRoleId):y.asDropdown("selectValue",[],!0);d=t.RowVersion!==null?t.RowVersion:""},n;$(o).on("fileSelected",function(n,t){l.val(t.replace("~",""))});$(o).on($.asEvent.page.ready,function(){r.asBootGrid({rowCount:[10,25,50,100],source:{url:""},requestHandler:function(n){if(h.asDropdown("selected")){u.items={};u.path="";var t="Name desc",i=0;return n.current>1&&(i=(n.current-1)*n.rowCount),$.each(n.sort,function(n,i){t=n+" "+i}),n.url=$.asInitService($.asUrls.cms_file_getByDefaultsLanguagesAndTypeCodeByPaging,[{name:"@typeCode",value:h.asDropdown("selected").value},{name:"@orderby",value:t},{name:"@skip",value:i},{name:"@top",value:n.rowCount}]),u.items={},r.asBootGrid("deselect"),n}return null},formatters:{Status:function(n,t){return t.Status?et.replace("@status",'checked="checked"').replace("@class","status"):et.replace("@status","").replace("@class","")}},selection:!0,rowSelect:!0,multiSelect:!0}).on("selected.rs.jquery.asBootGrid",function(n,t){ct(n,t)}).on("deselected.rs.jquery.asBootGrid",function(n,t){ct(n,t)})});s.on("change",function(){r.asBootGrid("reload")});h.on("change",function(){r.asBootGrid("reload")});vt.click(function(){s.asDropdown("selected")?it.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.fileSelector)},{name:"@isModal",value:!0}]),{path:s.asDropdown("selected").value,parent:o,event:"fileSelected"}):$.asShowMessage({template:"error",message:"هیچ مسیری انتخاب نشده است"})});lt.click(function(){ft.hide();g([{Id:0,Guid:null,Name:null,Description:null,Url:null,Status:!1,ViewRoleId:null,ModifyRoleId:null,AccessRoleId:null,TypeCode:null,RowVersion:null}]);f.asModal("show")});e.click(function(){var n=[];$.each(u.items,function(t,i){n.push(i)});n.length===1?(e.button("loading"),e.asAjax({url:$.asUrls.cms_file_delete,data:JSON.stringify({Id:n[0]}),success:function(){e.button("reset");r.asBootGrid("remove");wt()},error:function(){e.button("reset")}},{validate:!1,overlayClass:"as-overlay-absolute"})):$.asShowMessage({template:"error",message:"فایلی برای حذف انتخاب نشده است ."})});at.click(function(){var n=[];$.each(u.items,function(t,i){n.push(i)});n.length===1?(ft.show(),f.asModal("show"),f.asAjax({url:$.asInitService($.asUrls.cms_file_getById,[{name:"@id",value:n[0]}]),type:"get",success:function(n){$.isArray(n)?n.length>0?g(n):t():n!=null?typeof n!="undefined"?g(n):t():t()}},{overlayClass:"as-overlay-absolute"})):$.asShowMessage({template:"error",message:"هیچ فایلی انتخاب نشده است ."})});i("#btnCancel").click(function(){f.asModal("hide")});n=[];$.each(u.items,function(t,i){n.push(i)});n.length===1?rt.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.translator)},{name:"@isModal",value:!0}]),{type:"file",id:n[0],name:c.val(),description:a.val()}):$.asShowMessage({template:"error",message:"هیچ مسیری انتخاب نشده است"});yt.click(function(){f.asAjax({url:$.asUrls.cms_file_save,data:JSON.stringify({Id:k,Url:l.val(),Guid:b.val(),Name:c.val(),Description:a.val(),TypeCode:w.asDropdown("selected").value,Status:ut.is(":checked"),ViewRoleId:v.asDropdown("selected").value,ModifyRoleId:y.asDropdown("selected").value,AccessRoleId:p.asDropdown("selected").value,RowVersion:d}),success:function(n){k!==0&&r.asBootGrid("remove");r.asBootGrid("append",[n]);$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:tt,overlayClass:"as-overlay-absolute"})});nt=function(){r.asBootGrid("destroy");ot.destroy()}};kt();$(g).append('<span id="asRegisterPage"><\/span>');i("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})