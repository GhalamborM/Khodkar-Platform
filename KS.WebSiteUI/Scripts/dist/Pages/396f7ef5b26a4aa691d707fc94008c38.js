$("#i396f7ef5b26a4aa691d707fc94008c38").on($.asEvent.page.loaded,function(n,t){var it="#i396f7ef5b26a4aa691d707fc94008c38",rt=".i396f7ef5b26a4aa691d707fc94008c38."+$.asPageClass,i=function(n){var t=new $.as({pageId:rt});return t.as(n)},ut=function(){},tt,st,ht;$(it).on($.asEvent.page.dispose,function(){ut()});$.asUrls=$.extend({cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId:"/odata/cms/MasterDataKeyValues?$filter=TypeId%20eq%20@typeIdd&$select=Id%2CParentId%2CCode%2CPathOrUrl%2COrder%2CName%2CIsLeaf%2CKey%2CValue",cms_masterDataKeyValue_get:"/cms/masterdatakeyvalue/get/@id",cms_masterDataKeyValue_getType:"/odata/cms/MasterDataKeyValues?$filter=IsType%20eq%20true&$select=Id%2CParentTypeId%2CTypeId%2CCode%2COrder%2CName%2CKey%2CValue",develop_webConfig_settings_save:"/develop/webconfig/settings/save/",develop_webConfig_settings_dell:"/develop/webconfig/settings/delete/",develop_webConfig_settings_getSettingsByPagination:"/develop/webconfig/settings/GetSettingsByPagination/@orderBy/@skip/@take",develop_webConfig_settings_getMasterDataKeyValuePropertyName:"/develop/webconfig/settings/GetMasterDataKeyValuePropertyName/"},$.asUrls);var l=i("#frmConfig"),a=i("#btnDell"),vt=i("#btnEdit"),yt=i("#btnNew"),pt=i("#btnExecute"),f=i("#winAddOrEdit"),u=i("#grvSettings"),o=i("#drpMasterDataType"),s=i("#drpMasterData"),w=i("#drpMasterDataProperty"),b=i("#drpJavaScriptType"),h=i("#divMasterData"),c=i("#divSetting"),v=i("#divJavaScriptType"),r=i("#chkIsMasterData"),y=i("#chkInjectToJavaScript"),k=i("#txtKey"),d=i("#txtValue"),g=i("#txtDesc"),ft,p=!1,e={items:{}},nt="Id",et="None",ot='<div class="as-material-switch container-fluid @class"><div><input name="chkInjectToJavaScriptGrid" type="checkbox" @injectToJavaScript /><label class="label-default as-label" for="chkInjectToJavaScriptGrid" >  <\/label><\/div><\/div>';f.asModal({backdrop:"static",keyboard:!1});tt=function(n,t){n.type==="selected"?e.items[t[0].Key]={Key:t[0].Key,Value:t[0].Value,Description:t[0].Description,MasterDataKeyValuePropertyName:t[0].MasterDataKeyValuePropertyName,MasterDataKeyValueId:t[0].MasterDataKeyValueId,JavaScriptType:t[0].JavaScriptType,InjectToJavaScript:t[0].InjectToJavaScript,MasterDataKeyValueTypeId:t[0].MasterDataKeyValueTypeId}:delete e.items[t[0].Key]};u.asBootGrid({rowCount:[10,25,50,100,-1],source:{url:""},requestHandler:function(n){var t="Name desc",i=0;return n.current>1&&(i=(n.current-1)*n.rowCount),$.each(n.sort,function(n,i){t=n+" "+i}),n.url=$.asInitService($.asUrls.develop_webConfig_settings_getSettingsByPagination,[{name:"@orderby",value:t},{name:"@skip",value:i},{name:"@take",value:n.rowCount}]),e.items={},u.asBootGrid("deselect"),n},formatters:{InjectToJavaScript:function(n,t){return t.InjectToJavaScript?ot.replace("@injectToJavaScript",'checked="checked"').replace("@class","inject-to-javascript"):ot.replace("@injectToJavaScript","").replace("@class","")}},selection:!0,rowSelect:!0,multiSelect:!0}).on("selected.rs.jquery.asBootGrid",function(n,t){tt(n,t)}).on("deselected.rs.jquery.asBootGrid",function(n,t){tt(n,t)});s.asDropdown("init","نوع اطلاع پایه را انتخاب نمایید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},displayDataField:"Name",valueDataField:"Id",orderby:"Order"},selectParents:!0});st=function(){return $.asAjaxTask({url:$.asUrls.cms_masterDataKeyValue_getType})};ht=function(){return $.asAjaxTask({url:$.asUrls.develop_webConfig_settings_getMasterDataKeyValuePropertyName})};i("#divButtons").asAfterTasks([st(),ht()],function(n,t){o.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"TypeId"},parentDataField:{name:"ParentTypeId"},removeChildLessParent:!1},localData:n,displayDataField:"Name",valueDataField:"TypeId",orderby:"Order"},selectParents:!0},{overlayClass:"as-overlay-relative"});var i={source:{displayDataField:"Key",valueDataField:"Value",idDataField:"Key",localData:t},selectedValue:nt,selectedSearchKey:"Key",selectedItemKey:"Key",selectedItemtemplate:'<a style="color:#000 !important" class="btn btn-defaults dropdown-toggle" href="#" data-toggle="dropdown">@selectedText &nbsp; <span class="caret"><\/span><\/a>',itemTemplate:'<div class="as-flex-select-link" data-extera="@extera" data-text="@text" data-id="@id" data-value="@value" data-url="@url">@text<\/div>'};w.asFlexSelect(i);i.source.localData=[{Key:"String",Value:"String"},{Key:"Array",Value:"Array"},{Key:"Object",Value:"Object"},{Key:"Number",Value:"Number"},{Key:"Bool",Value:"Bool"},{Key:"None",Value:"None"}];b.asFlexSelect(i)});var wt=function(n){return $.asAjaxTask({url:n})},kt=function(){$.asNotFound("اطلاع پایه")},ct=function(n){var i=$.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,t=[];t.push("(TypeId%20eq%20@typeIdd)".replace("@typeId",o.asDropdown("selected").value));t.push("(ParentTypeId%20eq%20@typeIdd)".replace("@typeId",o.asDropdown("selected").value));f.asAfterTasks([wt(i.replace("TypeId%20eq%20@typeIdd","("+t.join("%20or%20")+")"))],function(t){s.asDropdown("reload",{localData:t});s.css({"margin-top":"0"});n!==null&&s.asDropdown("selectValue",n)},{overlayClass:"as-overlay-module"})},lt=function(n){w.asFlexSelect("setItem",n+'&nbsp;<span class="caret"><\/span>');nt=n},at=function(n){b.asFlexSelect("setItem",n+'&nbsp;<span class="caret"><\/span>');et=n},bt=function(){$(it).on($.asEvent.page.ready,function(){var n={txtKey:{required:{depends:function(){return r.is(":checked")===!1}}},txtValue:{required:{depends:function(){return r.is(":checked")===!1}}},drpMasterData:{asType:"asDropdown",required:{depends:function(){return r.is(":checked")===!0}}},drpMasterDataType:{asType:"asDropdown",required:{depends:function(){return r.is(":checked")===!0}}}};ft=l.asValidate({rules:n})});w.on("selectedIndexChanged",function(n,t,i,r){r&&lt(r)});b.on("selectedIndexChanged",function(n,t,i,r){r&&at(r)});r.change(function(){this.checked===!0?(h.show(),c.hide()):(c.show(),h.hide())});var n=function(){d.val("");k.val("");g.val("");y.prop("checked",!1);r.prop("checked",!1)},t=function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration});e.items={};u.asBootGrid("deselect")};y.change(function(){this.checked===!0?v.show():v.hide()});yt.click(function(){n();p=!0;h.hide();c.show();f.asModal("show")});pt.click(function(){f.asAjax({url:$.asUrls.develop_webConfig_settings_save,data:JSON.stringify({Value:d.val(),Key:k.val(),MasterDataKeyValueId:s.asDropdown("selected").value,MasterDataKeyValuePropertyName:nt,Description:g.val(),InjectToJavaScript:y.is(":checked"),IsMasterDataSetting:r.is(":checked"),JavaScriptType:et}),success:function(n){p===!0?p=!1:u.asBootGrid("remove");u.asBootGrid("append",[n]);t()}},{$form:l,overlayClass:"as-overlay-absolute"})});vt.click(function(){n();var t=[];$.each(e.items,function(n,i){t.push(i)});t.length===1?(p=!1,h.hide(),c.show(),f.asModal("show"),t[0].MasterDataKeyValueTypeId!==0?(h.show(),c.hide(),r.prop("checked",!0),o.asDropdown("selectValue",t[0].MasterDataKeyValueTypeId),ct(t[0].MasterDataKeyValueTypeId===0?null:t[0].MasterDataKeyValueId)):(d.val(t[0].Value),k.val(t[0].Key)),lt(t[0].MasterDataKeyValuePropertyName),g.val(t[0].Description),y.prop("checked",t[0].InjectToJavaScript),t[0].InjectToJavaScript?(v.show(),at(t[0].JavaScriptType===null||typeof t[0].JavaScriptType=="undefined"?"None":t[0].JavaScriptType)):v.hide()):$.asShowMessage({template:"error",message:"  برای ویرایش باید یک تنظیم انتخاب شود"})});a.click(function(){var n=[];$.each(e.items,function(t,i){n.push(i)});n.length===1?(l.asAjax({url:$.asUrls.develop_webConfig_settings_dell,data:JSON.stringify({Key:n[0].Key}),error:function(){a.button("reset")},success:function(){a.button("reset");u.asBootGrid("remove");t()}},{$form:l,validate:!1}),a.button("loading")):$.asShowMessage({template:"error",message:"  برای حذف یک تنظیم باید انتخاب شود"})});i("#btnCancel").click(function(){f.asModal("hide")});o.on("change",function(){ct(null)});ut=function(){u.asBootGrid("destroy");ft.destroy()}};bt();$(rt).append('<span id="asRegisterPage"><\/span>');i("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})