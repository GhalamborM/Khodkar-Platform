$("#ib07b899629ab4762ae63dabe3677e716").on($.asEvent.page.loaded,function(n,t){var pi="#ib07b899629ab4762ae63dabe3677e716",wi=".ib07b899629ab4762ae63dabe3677e716."+$.asPageClass,i=function(n){var t=new $.as({pageId:wi});return t.as(n)},bi=function(){},nr,tr,it,vi;$(pi).on($.asEvent.page.dispose,function(){bi()});$.asUrls=$.extend({cms_link_getByLanguage:"/odata/cms/Links?$filter=Language%20eq%20'@lang'&$select=Id%2CParentId%2CText%2CHtml%2CUrl%2COrder%2CIsLeaf",cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId:"/odata/cms/MasterDataKeyValues?$filter=TypeId%20eq%20@typeIdd&$select=Id%2CParentId%2CCode%2CPathOrUrl%2COrder%2CName%2CIsLeaf%2CKey%2CValue",cms_masterDataKeyValue_get:"/cms/masterdatakeyvalue/get/@id",cms_masterDataKeyValue_getType:"/odata/cms/MasterDataKeyValues?$filter=IsType%20eq%20true&$select=Id%2CParentTypeId%2CTypeId%2CCode%2COrder%2CName%2CKey%2CValue",cms_languageAndCulture_public_getAll:"/cms/languageAndCulture/public/getAll",security_Role_getAllByDefaultsLanguage:"/odata/security/Roles?$select=Id%2CParentId%2CName%2COrder%2CIsLeaf%2CDescription",cms_link_get:"/odata/cms/Links?$filter=Id%20eq%20@idd&$select=Id%2CText%2CHtml%2CTypeId%2CIconPath%2CIsLeaf%2CUrl%2COrder%2CParentId%2CShowToSearchEngine%2CViewRoleId%2CModifyRoleId%2CAccessRoleId%2CAction%2CTransactionCode%2CIsMobile%2CRowVersion%2CStatus",security_Permission_save:"/security/permission/Save",security_Permission_delete:"/security/permission/delete",develop_code_os_dotNet_getOutputVersions:"/develop/code/os/dotnet/GetOutputVersions/@codeId",develop_code_os_dotNet_getDotNetCodesVersionsById:"/odata/cms/MasterDataKeyValues?$filter=(TypeId%20eq%201041d)%20and%20(Id%20eq%20@idd)&$select=Id%2CVersion%2CName%2CCode%2COrder"},$.asUrls);var h=i("#frmQuery"),fr=i("#divRoles"),v=i("#drpViewRole"),y=i("#drpModifyRole"),p=i("#drpRole"),w=i("#drpAccessRole"),u=i("#drpMasterDataType"),e=i("#drpMasterData"),f=i("#drpPermission"),b=i("#drpActions"),k=i("#txtName"),er=i("#btnSave"),lt=i("#chkEditeMode"),or=i("#divFind"),ki=$.asModalManager.get({url:$.asModalManager.urls.translator}),kr=i("#txtFind"),dr=i("#txtReplace"),gr=i("#chkFindCase"),nu=i("#chkFindHole"),tu=i("#chkFindExp"),iu=i("#chkFindSelect"),ru=i("#editorToolbar"),uu=i("#lblEditor"),d=i("#txtDescription"),rt=i("#txtOrder"),sr=i("#winRestorEditor"),g=i("#txtId"),fi=i("#txtPermissionId"),di=i("#txtValue"),l=i("#chkPermission"),a=i("#chkNew"),ut=i("#txtCode"),at=i("#txtMasterDataCode"),vt=i("#txtMasterDataUrl"),ft=i("#chkCache"),yt=i("#chkStatus"),ei=i("#txtVersion"),hr=i("#txtSlidingExpirationTimeInMinutes"),pt=i("#txtParentId"),oi=i("#btnTranslator"),cr=i("#btnDell"),et=i("#divPermission"),wt=i("#divForeign"),bt=i("#divMasterdata"),kt=i("#divLink"),nt=i("#drpLink"),ot=i("#drpLanguge"),st=i("#divVersion"),tt=i("#drpVersion"),c=0,si=$.asGetDefaultsLnguageAndCulter().lang,dt=!0,gt=0,hi=0,ci=0,lr="",ht=0,li=!1,ct="",ni,ti,ar,r={},ii={},gi,ai={},o={source:{displayDataField:"country",valueDataField:"language",urlDataField:"flagUrl",idDataField:"culture",exteraDataField:"isRightToLeft"},selectedSearchKey:"language"};st.hide();wt.hide();et.hide();$.asTemp.serviceJavascriptQueryEditor=$.asTemp.serviceJavascriptQueryEditor||"";$.asTemp.serviceJavascriptQueryEditor!==""&&$.asStorage.setItem("serviceJavascriptQueryEditor",$.asTemp.serviceJavascriptQueryEditor);ki.asModal({width:800});or.asWindow({focusedId:"txtFind"});sr.asModal({backdrop:"static",keyboard:!1});nr=function(){return $.asAjaxTask({url:$.asUrls.security_Role_getAllByDefaultsLanguage})};fr.asAfterTasks([nr()],function(n){v.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}});w.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}});y.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}});p.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!0},valueDataField:"Id",displayDataField:"Description",orderby:"Order",localData:n}})},{overlayClass:"as-overlay-relative"});e.asDropdown("init","نوع اطلاع پایه را انتخاب نمایید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},displayDataField:"Name",valueDataField:"Id",orderby:"Order"},selectParents:!0});tt.asDropdown("init"," ابتدا کد را انتخاب نمایید",{source:{displayDataField:"Value",valueDataField:"Id",orderby:"Id"}});f.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,[{name:"@typeId",value:1032}]),displayDataField:"Name",valueDataField:"Id",orderby:"Order"},selectParents:!0});b.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,[{name:"@typeId",value:1031}]),displayDataField:"Name",valueDataField:"Id",orderby:"Order"}});u.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"TypeId"},parentDataField:{name:"ParentTypeId"},removeChildLessParent:!1},url:$.asUrls.cms_masterDataKeyValue_getType,displayDataField:"Name",valueDataField:"TypeId",orderby:"Order"},selectParents:!0});h.asValidate("validator").addMethod("regex",function(n,t,i){var r=new RegExp(i);return this.optional(t)||r.test(n)},"شناسه می تواند شامل اعدا حروف و . و _ و - باشد و با . یا - یا _ شروع نمی شود");tr={txtCode:{required:!0},txtPermissionId:{required:!0},txtName:{required:!0,maxlength:128},txtDescription:{maxlength:256},txtId:{maxlength:32,regex:"^[A-Za-z0-9][A-Za-z0-9_\\-\\.]*$"},drpViewRole:{asType:"asDropdown",required:!0},drpAccessRole:{asType:"asDropdown",required:!0},drpModifyRole:{asType:"asDropdown",required:!0},drpRole:{asType:"asDropdown",required:{depends:function(){return l.is(":checked")===!0}}},drpActions:{asType:"asDropdown",required:{depends:function(){return l.is(":checked")===!0}}},drpMasterData:{asType:"asDropdown",required:{depends:function(){return l.is(":checked")===!0}}}};gi=h.asValidate({rules:tr});it=function(n){return $.asAjaxTask({url:n})};vi=function(n){var i=$.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,t=[];t.push("(TypeId%20eq%20@typeIdd)".replace("@typeId",u.asDropdown("selected").value));t.push("(ParentTypeId%20eq%20@typeIdd)".replace("@typeId",u.asDropdown("selected").value));bt.asAfterTasks([it(i.replace("TypeId%20eq%20@typeIdd","("+t.join("%20or%20")+")"))],function(t){e.asDropdown("reload",{localData:t});e.css({"margin-top":"0"});n!==null&&e.asDropdown("selectValue",n);ur(n)},{overlayClass:"as-overlay-absolute"})};nt.asDropdown("init","کشور را انتخاب نمایید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!1},valueDataField:"Id",displayDataField:"Text",orderby:"Order"},selectParents:!0,removeChildLessParent:!1});var vr=function(n,t){if(t){var i=t.split("/");o.selectedValue=i[1]}else o.selectedValue=$.asGetDefaultsLnguageAndCulter().lang;dt&&ot.asAfterTasks([it($.asUrls.cms_languageAndCulture_public_getAll)],function(n){o.source.localData=n;ot.asFlexSelect(o)},{overlayClass:"as-overlay-fixed"});(dt||si!==o.selectedValue)&&(dt=!1,si=o.selectedValue,o.source.localData&&ot.asFlexSelect(o),kt.asAfterTasks([it($.asInitService($.asUrls.cms_link_getByLanguage,[{name:"@lang",value:o.selectedValue}]))],function(t){nt.asDropdown("reload",{localData:t});n&&nt.asDropdown("selectValue",n)},{overlayClass:"as-overlay-absolute"}))},ir=function(n,t){h.asAjax({url:$.asInitService($.asUrls.cms_link_get,[{name:"@id",value:n}]),type:"get",success:function(n){pr(n,t)}})},yr=function(){nt.on("change",function(n,t){typeof t.value!="undefined"&&ir(t.value)});ot.on("selectedIndexChanged",function(n,t,i,r,u){u&&(si=i,ot.asFlexSelect("setItem",'<img src="'+u+'">&nbsp;<span class="caret"><\/span>'),nt.asDropdown("reload",{url:$.asInitService($.asUrls.cms_link_getByLanguage,[{name:"@lang",value:i}])}))})},yi=function(n,t){dt&&yr();vr(n,t)},rr=function(n){bt.hide();kt.show();n?ir(n,!0):yi()},pr=function(n,t){$.isArray(n)?n.length>0?(ri({PathOrUrl:n[0].Url,Code:""}),t&&yi(n[0].Id,n[0].Url)):s("لینک"):n!=null?typeof n!="undefined"?(ri({PathOrUrl:n.Url,Code:""}),t&&yi(n.Id,n.Url)):s("لینک"):s("لینک")},wr=function(){tt.on("change",function(n,t){c=t.value===null?0:t.value});l.change(function(){this.checked===!0?(wt.hide(),et.show()):(et.hide(),wt.show())});$(pi).on($.asEvent.page.ready,function(){});ft.change(function(){i("#divSlidingExpirationTimeInMinutes").prop("disabled",!this.checked)});a.change(function(){this.checked===!0?li===!0?($.asShowMessage({template:"error",message:"امکان افزودن یک اطلاع پایه به یک اطلاع پایه دیگر وجود ندارد"}),a.prop("checked",!1)):(g.prop("disabled",!1),r.Id=ht,ht=0,r.Isleaf=li,r.ParentId=pt.val(),pt.val(fi.val()),r.RowVersion=ct,ct="",r.Name=k.val(),k.val(""),r.Description=d.val(),d.val(""),r.Code=ut.val(),ut.val(""),r.Guid=g.val(),r.NewGuid=ni,g.val(ni),r.NewId=ti,fi.val(ti),r.Version=ei.val(),ei.val("0"),r.Order=rt.val(),rt.val(""),r.Key=u.asDropdown("selected").value,u.asDropdown("selectValue",[],!0),r.ForeignKey3=e.asDropdown("selected").value,e.asDropdown("selectValue",[],!0),r.ForeignKey2=p.asDropdown("selected").value,p.asDropdown("selectValue",[],!0),r.ForeignKey1=b.asDropdown("selected").value,b.asDropdown("selectValue",[],!0),r.Value=di.val(),di.val(""),r.EnableCache=ft.prop("checked"),ft.prop("checked",!1),r.EditMode=lt.prop("checked"),lt.prop("checked",!1),r.Status=yt.prop("checked"),yt.prop("checked",!1),r.ViewRoleId=gt,v.asDropdown("selectValue",[],!0),r.AccessRoleId=ci,w.asDropdown("selectValue",[],!0),r.ModifyRoleId=hi,y.asDropdown("selectValue",[],!0),r.ForeignUrl=vt.val(),vt.val(""),r.ForeignCode=at.val(),at.val("")):ui(r)});cr.click(function(){f.asDropdown("selected")?h.asAjax({url:$.asUrls.security_Permission_delete,data:JSON.stringify({Id:f.asDropdown("selected").value}),success:function(){f.asDropdown("removeItem");$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:h}):$.asShowMessage({template:"error",message:"برای حذف یک اطلاع پایه را انتخاب نمایید. "})});er.click(function(){var n,t;f.asDropdown("selected")&&(a.is(":checked")?(t=ni,n=ti):(t=g.val(),n=f.asDropdown("selected").value));v.asDropdown("selected")&&(gt=v.asDropdown("selected").value);y.asDropdown("selected")&&(hi=y.asDropdown("selected").value);w.asDropdown("selected")&&(ci=w.asDropdown("selected").value);l.is(":checked")===!1&&a.is(":checked")&&(ai[n]=!0);h.asAjax({url:$.asUrls.security_Permission_save,data:JSON.stringify({Id:n,ParentId:pt.val(),TypeId:1032,PathOrUrl:"/",ViewRoleId:gt,ModifyRoleId:hi,AccessRoleId:ci,Code:ut.val(),Name:k.val(),Description:d.val(),Guid:t,Order:rt.val(),Key:u.asDropdown("selected").value,Value:c,ForeignKey3:u.asDropdown("selected").value===101?nt.asDropdown("selected").value:e.asDropdown("selected").value,ForeignKey2:p.asDropdown("selected").value,ForeignKey1:b.asDropdown("selected").value,Status:yt.is(":checked"),EnableCache:ft.is(":checked"),EditMode:lt.is(":checked"),IsLeaf:l.is(":checked"),IsType:!1,IsNew:a.is(":checked"),SlidingExpirationTimeInMinutes:hr.val(),RowVersion:ct}),success:function(t){if(a.is(":checked")){var i=!1;ai[ii.value]&&(i=!0,delete ai[ii.value]);f.asDropdown("addItem",{text:k.val(),value:n},ii,i)}ui(t);$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:h})});f.on("change",function(n,t){oi.removeClass("disabled");oi.prop("disabled",!1);bt.show();kt.hide();ii=t;typeof t.value!="undefined"&&br(t.value)});e.on("change",function(n,t){e.asDropdown("selected")&&ur(t.value)});u.on("change",function(n,t){t.value===101?rr():vi(null)});oi.click(function(){ki.asModal("load",$.asInitService($.asFormUrl,[{name:"@url",value:$.asUrlAsParameter($.asModalManager.urls.translator)},{name:"@isModal",value:!0}]),{type:"masterDataKeyValue",id:ht,name:k.val(),description:d.val()})});bi=function(){window.clearInterval(ar);gi.destroy()}};wr();var s=function(n){$.asNotFound(n)},ri=function(n){n.PathOrUrl!==null?vt.val(n.PathOrUrl):vt.val("");n.Code!==null?at.val(n.Code):at.val("");n.ForeignKey1?(n.ForeignKey1===757||n.ForeignKey1===753||n.ForeignKey1===752||n.ForeignKey1===754||n.ForeignKey1===755||n.ForeignKey1===979)&&(st.show(),n.ForeignKey1===757||n.ForeignKey1===979?st.asAfterTasks([it($.asInitService($.asUrls.develop_code_os_dotNet_getOutputVersions,[{name:"@codeId",value:n.Id}]))],function(n){tt.asDropdown("reload",{localData:n});tt.asDropdown("selectValue",[c===0?null:c])},{overlayClass:"as-overlay-absolute"}):st.asAfterTasks([it($.asInitService($.asUrls.develop_code_os_dotNet_getDotNetCodesVersionsById,[{name:"@id",value:n.Id}]))],function(n){var t=[];$.each(n,function(n,i){t.push({Id:i.Version,Value:i.Version})});t.push({Id:0,Value:"آخرین نگارشی که کامپایل شده یا خواهد شد"});tt.asDropdown("reload",{localData:t});tt.asDropdown("selectValue",[c===0?null:c])},{overlayClass:"as-overlay-absolute"})):st.hide()},ur=function(n){(bt.show(),kt.hide(),n!==null)&&wt.asAjax({url:$.asInitService($.asUrls.cms_masterDataKeyValue_get,[{name:"@id",value:n}]),type:"get",success:function(n){$.isArray(n)?n.length>0?ri(n):s("اطلاع پایه"):n!=null?typeof n!="undefined"?ri(n):s("اطلاع پایه"):s("اطلاع پایه")}},{overlayClass:"as-overlay-absolute"})},br=function(n){f.asDropdown("selectValue",[],!0);f.asDropdown("selectValue",n);gt=0;lr="";ser=0;ct="";h.asAjax({url:$.asInitService($.asUrls.cms_masterDataKeyValue_get,[{name:"@id",value:n}]),type:"get",success:function(n){$.isArray(n)?n.length>0?ui(n,!0):s("مجوز"):n!=null?typeof n!="undefined"?ui(n,!0):s("مجوز"):s("مجوز")}})},ui=function(n,t){n.Key!==null?(u.asDropdown("selectValue",n.Key),t&&(n.Key===101?rr(n.ForeignKey3):vi(n.ForeignKey3))):u.asDropdown("selectValue",[],!0);i("#divLastModifiUser").html(n.LastModifieUser);i("#divLastModifiLocalDataTime").html(n.LastModifieLocalDateTime);n.ForeignKey2!==null?p.asDropdown("selectValue",n.ForeignKey2):p.asDropdown("selectValue",[],!0);n.ForeignKey1!==null?b.asDropdown("selectValue",n.ForeignKey1):b.asDropdown("selectValue",[],!0);g.prop("disabled",!0);a.prop("checked",!1);ht=n.Id;fi.val(ht);pt.val(n.ParentId);ct=n.RowVersion;l.prop("checked",n.IsLeaf);n.IsLeaf?et.show():et.hide();li=n.IsLeaf;k.val(n.Name);n.Description!=null?d.val(n.Description):d.val("");n.Code!==null?ut.val(n.Code):ut.val("");g.val(n.Guid);ni=n.NewGuid;ti=n.NewId;ei.val(n.Version);n.Order!==null?rt.val(n.Order):rt.val("");n.Key!==null?u.asDropdown("selectValue",n.Key):u.asDropdown("selectValue",[],!0);c=n.Value!==null?n.Value:0;ft.prop("checked",n.EnableCache);lt.prop("checked",n.EditMode);yt.prop("checked",n.Status);n.ViewRoleId!==null?v.asDropdown("selectValue",n.ViewRoleId):v.asDropdown("selectValue",[],!0);n.AccessRoleId!=null?w.asDropdown("selectValue",n.AccessRoleId):w.asDropdown("selectValue",[],!0);n.ModifyRoleId!=null?y.asDropdown("selectValue",n.ModifyRoleId):y.asDropdown("selectValue",[],!0)};$(wi).append('<span id="asRegisterPage"><\/span>');i("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})