$("#i6da76777e0814da8a44a9ef4d18ed70b").on($.asEvent.page.loaded,function(n,t){var rt="#i6da76777e0814da8a44a9ef4d18ed70b",ut=".i6da76777e0814da8a44a9ef4d18ed70b."+$.asPageClass,i=function(n){var t=new $.as({pageId:ut});return t.as(n)},ft=function(){},lt,at;$(rt).on($.asEvent.page.dispose,function(){ft()});$.asUrls=$.extend({security_Role_getAllByOtherLanguage:"/odata/security/LocalRoles?$filter=(Language%20eq%20'@lang')&$expand=Role&$select=Role%2FId%2CRole%2FParentId%2CRole%2FName%2CRole%2FOrder%2CRole%2FIsLeaf%2CName",security_Group_getAllByOtherLanguage:"/odata/security/LocalGroups?$filter=Language%20eq%20'@lang'&$expand=Group&$select=Group%2FId%2CGroup%2FParentId%2CGroup%2FName%2CGroup%2FOrder%2CGroup%2FIsLeaf%2CName",security_User_GetUsersByPaging:"/security/user/GetUsersByPagination/@groupId/@orderby/@skip/@take",security_User_Save:"/security/user/Save",security_User_Dell:"/security/user/delete"},$.asUrls);var et=i("#frm"),f=i("#winAddOrEdit"),l=i("#drpGroups"),k=i("#txtLastName"),d=i("#txtFirstName"),g=i("#txtAliasName"),ot=i("#txtPassword"),yt=i("#txtPasswordAgain"),nt=i("#txtMail"),e=i("#txtUserName"),r=i("#grvUsers"),pt=i("#btnNew"),wt=i("#btnEdit"),o=i("#btnDell"),bt=i("#btnExecute"),st=i("#chkStatus"),kt=i("#divRoles"),a=i("#drpViewRole"),v=i("#drpModifyRole"),y=i("#drpAccessRole"),p=i("#drpGroupsAddUpdate"),s=i("#chkChangePass"),tt=i("#divPass"),w=[],h=[],c=[],b=!1,u={items:{}},it=0,ht='<div class="as-material-switch container-fluid @class"><div><input name="chkStatusGrid" type="checkbox" @status /><label class="label-default as-label" for="chkStatusGrid" >  <\/label><\/div><\/div>',ct,dt=function(){$.asShowMessage({message:$.asRes[$.asLang].successOpration});u.items={};r.asBootGrid("deselect")},gt={drpViewRole:{asType:"asDropdown",required:!0},drpAccessRole:{asType:"asDropdown",required:!0},drpModifyRole:{asType:"asDropdown",required:!0},txtLastName:{required:!0},txtAliasName:{required:!0},txtPassword:{required:{depends:function(){return s.is(":checked")===!0}},minlength:s.is(":checked")===!0?6:0,maxlength:20},txtPasswordAgain:{equalTo:"#txtPassword"},txtFirstName:{required:!0},txtUserName:{required:!0,minlength:5,maxlength:45,email:!0},txtMail:{required:!0,minlength:5,maxlength:45,email:!0}};ct=et.asValidate({rules:gt});f.asModal({backdrop:"static",keyboard:!1});lt=function(){return $.asAjaxTask({url:$.asInitService($.asUrls.security_Group_getAllByOtherLanguage,[{name:"@lang",value:$.asLang}])})};i("#divGroups").asAfterTasks([lt()],function(n){l.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Group.Id"},parentDataField:{name:"Group.ParentId"}},localData:n,displayDataField:"Name",valueDataField:"Group.Id",orderby:"Group.Order"}});p.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Group.Id"},parentDataField:{name:"Group.ParentId"},removeChildLessParent:!1},localData:n,displayDataField:"Name",valueDataField:"Group.Id",orderby:"Group.Order"},multiple:!0})},{overlayClass:"as-overlay-relative"});at=function(){return $.asAjaxTask({url:$.asInitService($.asUrls.security_Role_getAllByOtherLanguage,[{name:"@lang",value:$.asLang}])})};kt.asAfterTasks([at()],function(n){a.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Role.Id"},parentDataField:{name:"Role.ParentId"},childrenDataField:"Children",isLeafDataField:"Role.IsLeaf",removeChildLessParent:!0},valueDataField:"Role.Id",displayDataField:"Name",orderby:"Role.Order",localData:n}});y.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Role.Id"},parentDataField:{name:"Role.ParentId"},childrenDataField:"Children",isLeafDataField:"Role.IsLeaf",removeChildLessParent:!0},valueDataField:"Role.Id",displayDataField:"Name",orderby:"Role.Order",localData:n}});v.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Role.Id"},parentDataField:{name:"Role.ParentId"},childrenDataField:"Children",isLeafDataField:"Role.IsLeaf",removeChildLessParent:!0},valueDataField:"Role.Id",displayDataField:"Name",orderby:"Role.Order",localData:n}})},{overlayClass:"as-overlay-relative"});var ti=function(){r.asBootGrid("reload")},vt=function(n,t){n.type==="selected"?u.items[t[0].UserName]=t[0]:delete u.items[t[0].UserName]},ni=function(){var t=function(){$.asNotFound(" User")},n=function(n){w=[];h=[];c=[];it=n.Id;n.LastName!==null?k.val(n.LastName):k.val("");n.FirstName!==null?d.val(n.FirstName):d.val("");n.AliasName!==null?g.val(n.AliasName):g.val("");n.Email!==null?nt.val(n.Email):nt.val("");n.UserName!==null?e.val(n.UserName):e.val("");b?e.removeAttr("disabled"):e.attr("disabled","disabled");ot.val("");yt.val("");st.prop("checked",n.Status);s.prop("checked",!1);tt.hide();$.each(n.Groups,function(n,t){w.push(t.GroupId)});p.asDropdown("selectValue",[],!0);p.asDropdown("selectValue",w);n.ViewRoleId!==null?a.asDropdown("selectValue",n.ViewRoleId):a.asDropdown("selectValue",[],!0);n.AccessRoleId!==null?y.asDropdown("selectValue",n.AccessRoleId):y.asDropdown("selectValue",[],!0);n.ModifyRoleId!==null?v.asDropdown("selectValue",n.ModifyRoleId):v.asDropdown("selectValue",[],!0)};$(rt).on($.asEvent.page.ready,function(){r.asBootGrid({rowCount:[10,25,50,100],source:{url:""},requestHandler:function(n){if(l.asDropdown("selected")){u.items={};var t="UserName desc",i=0;return n.current>1&&(i=(n.current-1)*n.rowCount),$.each(n.sort,function(n,i){t=n+" "+i}),n.url=$.asInitService($.asUrls.security_User_GetUsersByPaging,[{name:"@groupId",value:l.asDropdown("selected").value},{name:"@orderby",value:t},{name:"@skip",value:i},{name:"@take",value:n.rowCount}]),u.items={},r.asBootGrid("deselect"),n}return null},formatters:{Status:function(n,t){return t.Status?ht.replace("@status",'checked="checked"').replace("@class",""):ht.replace("@status","").replace("@class","status")}},selection:!0,rowSelect:!0,multiSelect:!0}).on("selected.rs.jquery.asBootGrid",function(n,t){vt(n,t)}).on("deselected.rs.jquery.asBootGrid",function(n,t){vt(n,t)})});l.on("change",function(){r.asBootGrid("reload")});p.on("change",function(n,t){typeof t.value!="undefined"&&(w.indexOf(t.value)>-1?t.selected===!1?c.push(t.value):c.indexOf(t.value)>-1&&c.splice(index,1):t.selected===!0?h.push(t.value):h.indexOf(t.value)>-1&&h.splice(index,1))});pt.click(function(){b=!0;f.asModal("show");n({Id:0,LastName:null,FirstName:null,Email:null,UserName:null,AliasName:null,Status:!1,ViewRoleId:null,ModifyRoleId:null,AccessRoleId:null})});o.click(function(){var n=[];$.each(u.items,function(t,i){n.push(i)});n.length===1?(o.asAjax({url:$.asUrls.security_User_Dell,data:JSON.stringify({Id:n[0].Id}),success:function(){o.button("reset");r.asBootGrid("remove");dt()},error:function(){o.button("reset")}},{validate:!1,overlayClass:"as-overlay-absolute"}),o.button("loading")):$.asShowMessage({template:"error",message:"A user must be selected for removal"})});wt.click(function(){b=!1;var t=[];$.each(u.items,function(n,i){t.push(i)});t.length===1?(f.asModal("show"),n(t[0])):$.asShowMessage({template:"error",message:"A user must be selected for edit"})});i("#btnCancel").click(function(){f.asModal("hide")});bt.click(function(){f.asAjax({url:$.asUrls.security_User_Save,data:JSON.stringify({Id:it,AliasName:g.val(),LastName:k.val(),FirstName:d.val(),Status:st.is(":checked"),ViewRoleId:a.asDropdown("selected").value,ModifyRoleId:v.asDropdown("selected").value,AccessRoleId:y.asDropdown("selected").value,Password:ot.val(),UserName:e.val(),IsChangePass:s.is(":checked"),Email:nt.val(),RemovedList:c,AddedList:h,IsNew:b}),success:function(n){it!==0&&r.asBootGrid("remove");r.asBootGrid("append",[n]);$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:et,overlayClass:"as-overlay-absolute"})});s.change(function(){this.checked===!0?tt.show():tt.hide()});ft=function(){r.asBootGrid("destroy");ct.destroy()}};ni();$(ut).append('<span id="asRegisterPage"><\/span>');i("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})