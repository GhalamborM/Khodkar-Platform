$("#i54a03aaaed844a0dbd474ab8c2d1b335").on($.asEvent.page.loaded,function(n,t){var p="#i54a03aaaed844a0dbd474ab8c2d1b335",w=".i54a03aaaed844a0dbd474ab8c2d1b335."+$.asPageClass,i=function(n){var t=new $.as({pageId:w});return t.as(n)},b=function(){},g;$(p).on($.asEvent.page.dispose,function(){b()});$.asUrls=$.extend({cms_link_getByLanguage:"/odata/cms/Links?$filter=Language%20eq%20'@lang'&$select=Id%2CParentId%2CText%2CHtml%2CUrl%2COrder%2CIsLeaf",cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId:"/odata/cms/MasterDataKeyValues?$filter=TypeId%20eq%20@typeIdd&$select=Id%2CParentId%2CCode%2CPathOrUrl%2COrder%2CName%2CIsLeaf%2CKey%2CValue",cms_masterDataKeyValue_getType:"/odata/cms/MasterDataKeyValues?$filter=IsType%20eq%20true&$select=Id%2CParentTypeId%2CTypeId%2CCode%2COrder%2CName%2CKey%2CValue",cms_languageAndCulture_public_getAll:"/cms/languageAndCulture/public/getAll",cms_entityGroup_get:"/odata/cms/EntityGroups?$filter=GroupId%20eq%20@groupIdd&$select=Id%2CLinkId%2CMasterDataKeyValueId%2CCommentId%2CEntityTypeId",cms_entityGroup_save:"/cms/entityGroup/save"},$.asUrls);var o=i("#frmGroups"),a=i("#drpGroup"),v=i("#drpMasterDataType"),r=i("#drpMasterData"),s=i("#drpLink"),y=i("#drpLanguge"),rt=i("#btnLinkToGroup"),ut=i("#btnMasterDataToGroup"),u=[],f=[],e=[],h=[],c=[],l=[],k,d;d=o.asValidate({rules:{drpGroup:{asType:"asDropdown",required:!0}}});a.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"}},url:$.asInitService($.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,[{name:"@typeId",value:1015}]),displayDataField:"Name",valueDataField:"Id",orderby:"Order"},parentMode:"uniq"});r.asDropdown("init","نوع اطلاع پایه را انتخاب نمایید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},removeChildLessParent:!1},displayDataField:"Name",valueDataField:"Id",orderby:"Order"},multiple:!0,selectParents:!0});v.asDropdown({source:{hierarchy:{type:"flat",keyDataField:{name:"TypeId"},parentDataField:{name:"ParentTypeId"},removeChildLessParent:!1},url:$.asUrls.cms_masterDataKeyValue_getType,displayDataField:"Name",valueDataField:"TypeId",orderby:"Order"},selectParents:!0});s.asDropdown("init","کشور را انتخاب نمایید",{source:{hierarchy:{type:"flat",keyDataField:{name:"Id"},parentDataField:{name:"ParentId"},childrenDataField:"Children",removeChildLessParent:!1},valueDataField:"Id",displayDataField:"Text",orderby:"Order"},multiple:!0,selectParents:!0});g=function(){return $.asAjaxTask({url:$.asUrls.cms_languageAndCulture_public_getAll})};y.asAfterTasks([g()],function(n){var i={source:{displayDataField:"country",valueDataField:"language",urlDataField:"flagUrl",idDataField:"culture",exteraDataField:"isRightToLeft",localData:n}},t=$.asGetDefaultsLnguageAndCulter();t&&(s.asDropdown("reload",{url:$.asInitService($.asUrls.cms_link_getByLanguage,[{name:"@lang",value:t.lang}])}),k=t.lang,i.selectedValue=t.country);y.asFlexSelect(i)},{overlayClass:"as-overlay-fixed"});var nt=function(n,t,i,s){o.asAjax({url:$.asUrls.cms_entityGroup_save,data:JSON.stringify({GroupId:n,EntityTypeId:t,RemovedList:i,AddedList:s,Name:a.asDropdown("selected").text}),success:function(n){n==="masterData"&&(u=e=f=[],r.asDropdown("selected")&&$.each(r.asDropdown("selected"),function(n,t){t.selected&&u.push(t.value)}));$.asShowMessage({message:$.asRes[$.asLang].successOpration})}},{$form:o})},tt=function(n){return $.asAjaxTask({url:n})},it=function(n,t){var s=$.asUrls.cms_masterDataKeyValue_GetByDefaultsLanguageAndTypeId,o=[];o.push("(TypeId%20eq%20@typeIdd)".replace("@typeId",n));o.push("(ParentTypeId%20eq%20@typeIdd)".replace("@typeId",n));i("#masterdata").asAfterTasks([tt(s.replace("TypeId%20eq%20@typeIdd","("+o.join("%20or%20")+")"))],function(n){u=n;f=[];e=[];r.asDropdown("reload",{localData:n});typeof t!="undefined"&&r.asDropdown("selectValue",t)},{overlayClass:"as-overlay-fixed"});r.css({"margin-top":"0"})},ft=function(n){s.asDropdown("selectValue",[],!0);r.asDropdown("selectValue",[],!0);h=[];l=[];c=[];u=[];e=[];f=[];o.asAjax({url:$.asInitService($.asUrls.cms_entityGroup_get,[{name:"@groupId",value:n}]),type:"get",success:function(n){var t;$.isArray(n)&&n.length>0&&$.each(n,function(n,i){i.EntityTypeId==101?h.push(i.LinkId):(t=i.EntityTypeId,u.push(i.MasterDataKeyValueId))});h.length!=0&&s.asDropdown("selectValue",h);u.length!=0&&(v.asDropdown("selectValue",t),it(t,u))}})},et=function(){$(p).on($.asEvent.page.ready,function(){});y.on("selectedIndexChanged",function(n,t,r,u,f){f&&y.asFlexSelect("setItem",'<img src="'+f+'">&nbsp;<span class="caret"><\/span>');i("#link").asAfterTasks([tt($.asInitService($.asUrls.cms_link_getByLanguage,[{name:"@lang",value:r}]))],function(n){h=n;c=l=[];s.asDropdown("reload",{localData:n})},{overlayClass:"as-overlay-absolute-no-height"});k=r});a.on("change",function(n,t){typeof t.value!="undefined"&&ft(t.value)});r.on("change",function(n,t){typeof t.value!="undefined"&&($.asFindInJsonArray(u,"Id",t.value)!=null?t.selected===!1?e.push(t.value):e.indexOf(t.value)>-1&&e.splice(index,1):t.selected===!0?f.push(t.value):f.indexOf(t.value)>-1&&f.splice(index,1))});v.on("change",function(n,t){typeof t.value!="undefined"&&it(t.value)});s.on("change",function(n,t){typeof t.value!="undefined"&&(h.indexOf(t.value)>-1?t.selected===!1?l.push(t.value):l.indexOf(t.value)>-1&&l.splice(index,1):t.selected===!0?c.push(t.value):c.indexOf(t.value)>-1&&c.splice(index,1))});rt.click(function(){o.asValidate("valid")&&nt(a.asDropdown("selected").value,"101",l,c)});ut.click(function(){o.asValidate("valid")&&nt(a.asDropdown("selected").value,v.asDropdown("selected").value,e,f)});b=function(){d.destroy()}};et();$(w).append('<span id="asRegisterPage"><\/span>');i("#asRegisterPage").asRegisterPageEvent();typeof t!="undefined"&&$.asLoadPage(t,t.replace(/\//g,$.asUrlDelimeter))})