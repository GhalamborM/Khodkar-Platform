tinymce.ThemeManager.add("modern",function(j){var s=this,t=j.settings,k=tinymce.ui.Factory,i=tinymce.each,h=tinymce.DOM,n=tinymce.geom.Rect,m=tinymce.ui.FloatPanel;var f={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}};var g="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";function d(v,w){var x=[],u;if(!v){return}i(v.split(/[ ,]/),function(z){var A;function y(){var B=j.selection;function C(D){return function(H,E){var G,F=E.parents.length;while(F--){G=E.parents[F].nodeName;if(G=="OL"||G=="UL"){break}}z.active(H&&G==D)}}if(A=="bullist"){B.selectorChanged("ul > li",C("UL"))}if(A=="numlist"){B.selectorChanged("ol > li",C("OL"))}if(z.settings.stateSelector){B.selectorChanged(z.settings.stateSelector,function(D){z.active(D)},true)}if(z.settings.disabledStateSelector){B.selectorChanged(z.settings.disabledStateSelector,function(D){z.disabled(D)})}}if(z=="|"){u=null}else{if(k.has(z)){z={type:z,size:w};x.push(z);u=null}else{if(!u){u={type:"buttongroup",items:[]};x.push(u)}if(j.buttons[z]){A=z;z=j.buttons[A];if(typeof z=="function"){z=z()}z.type=z.type||"button";z.size=w;z=k.create(z);u.items.push(z);if(j.initialized){y()}else{j.on("init",y)}}}}});return{type:"toolbar",layout:"flow",items:x}}function e(w){var x=[];function u(y){if(y){x.push(d(y,w));return true}}if(tinymce.isArray(t.toolbar)){if(t.toolbar.length===0){return}tinymce.each(t.toolbar,function(z,y){t["toolbar"+(y+1)]=z});delete t.toolbar}for(var v=1;v<10;v++){if(!u(t["toolbar"+v])){break}}if(!x.length&&t.toolbar!==false){u(t.toolbar||g)}if(x.length){return{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:true,ariaRemember:true,items:x}}}function c(){var B,A=[];function v(D){var C;if(D=="|"){return{text:"|"}}C=j.menuItems[D];return C}function u(C){var G,F,H,E,I;I=tinymce.makeMap((t.removed_menuitems||"").split(/[ ,]/));if(t.menu){F=t.menu[C];E=true}else{F=f[C]}if(F){G={text:F.title};H=[];i((F.items||"").split(/[ ,]/),function(J){var K=v(J);if(K&&!I[J]){H.push(v(J))}});if(!E){i(j.menuItems,function(J){if(J.context==C){if(J.separator=="before"){H.push({text:"|"})}if(J.prependToContext){H.unshift(J)}else{H.push(J)}if(J.separator=="after"){H.push({text:"|"})}}})}for(var D=0;D<H.length;D++){if(H[D].text=="|"){if(D===0||D==H.length-1){H.splice(D,1)}}}G.menu=H;if(!G.menu.length){return null}}return G}var w=[];if(t.menu){for(B in t.menu){w.push(B)}}else{for(B in f){w.push(B)}}var x=typeof t.menubar=="string"?t.menubar.split(/[ ,]/):w;for(var y=0;y<x.length;y++){var z=x[y];z=u(z);if(z){A.push(z)}}return A}function a(v){function u(x){var w=v.find(x)[0];if(w){w.focus(true)}}j.shortcuts.add("Alt+F9","",function(){u("menubar")});j.shortcuts.add("Alt+F10","",function(){u("toolbar")});j.shortcuts.add("Alt+F11","",function(){u("elementpath")});v.on("cancel",function(){j.focus()})}function r(A,x){var u,y,v,z;function w(B){return{width:B.clientWidth,height:B.clientHeight}}u=j.getContainer();y=j.getContentAreaContainer().firstChild;v=w(u);z=w(y);if(A!==null){A=Math.max(t.min_width||100,A);A=Math.min(t.max_width||65535,A);h.setStyle(u,"width",A+(v.width-z.width));h.setStyle(y,"width",A)}x=Math.max(t.min_height||100,x);x=Math.min(t.max_height||65535,x);h.setStyle(y,"height",x);j.fire("ResizeEditor")}function q(v,u){var w=j.getContentAreaContainer();s.resizeTo(w.clientWidth+v,w.clientHeight+u)}function b(){var D;function w(){return j.contextToolbars||[]}function x(I){var J,L,K;J=tinymce.DOM.getPos(j.getContentAreaContainer());L=j.dom.getRect(I);K=j.dom.getRoot();if(K.nodeName=="BODY"){L.x-=K.ownerDocument.documentElement.scrollLeft||K.scrollLeft;L.y-=K.ownerDocument.documentElement.scrollTop||K.scrollTop}L.x+=J.x;L.y+=J.y;return L}function z(){i(j.contextToolbars,function(I){if(I.panel){I.panel.hide()}})}function G(I,K,J){K=K?K.substr(0,2):"";i({t:"down",b:"up"},function(L,M){I.classes.toggle("arrow-"+L,J(M,K.substr(0,1)))});i({l:"left",r:"right"},function(L,M){I.classes.toggle("arrow-"+L,J(M,K.substr(1,1)))})}function F(I){return{left:I.x,top:I.y,width:I.w,height:I.h,right:I.x+I.w,bottom:I.y+I.h}}function H(L,M,J,I,K){K=F({x:L,y:M,w:K.w,h:K.h});if(t.inline_toolbar_position_handler){K=t.inline_toolbar_position_handler({elementRect:F(J),contentAreaRect:F(I),panelRect:K})}return K}function A(I,J){I.moveTo(J.left,J.top)}function B(K){var N,M,J,I,L,O,P;if(j.removed){return}if(!K||!K.toolbar.panel){z();return}P=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"];L=K.toolbar.panel;L.show();J=x(K.element);M=tinymce.DOM.getRect(L.getEl());I=tinymce.DOM.getRect(j.getContentAreaContainer()||j.getBody());J.w=K.element.clientWidth;J.h=K.element.clientHeight;if(!j.inline){I.w=j.getDoc().documentElement.offsetWidth}if(j.selection.controlSelection.isResizable(K.element)){J=n.inflate(J,0,8)}N=n.findBestRelativePosition(M,J,I,P);J=n.clamp(J,I);if(N){O=n.relativePosition(M,J,N);A(L,H(O.x,O.y,J,I,M))}else{I.h+=40;J=n.intersect(I,J);if(J){N=n.findBestRelativePosition(M,J,I,["bc-tc","bl-tl","br-tr"]);if(N){O=n.relativePosition(M,J,N);A(L,H(O.x,O.y,J,I,M))}else{A(L,H(J.x,J.y,J,I,M))}}else{L.hide()}}G(L,N,function(Q,R){return(!J||J.w>40)&&Q===R})}function C(){function I(){if(j.selection){B(v(j.selection.getNode()))}}tinymce.util.Delay.requestAnimationFrame(I)}function u(){if(!D){D=j.selection.getScrollContainer()||j.getWin();tinymce.$(D).on("scroll",C);j.on("remove",function(){tinymce.$(D).off("scroll")})}}function E(I){var J;if(I.toolbar.panel){I.toolbar.panel.show();B(I);return}u();J=k.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:true,border:1,items:d(I.toolbar.items),oncancel:function(){j.focus()}});I.toolbar.panel=J;J.renderTo(document.body).reflow();B(I)}function y(){tinymce.each(w(),function(I){if(I.panel){I.panel.hide()}})}function v(K){var I,M,J,L=w();J=j.$(K).parents().add(K);for(I=J.length-1;I>=0;I--){for(M=L.length-1;M>=0;M--){if(L[M].predicate(J[I])){return{toolbar:L[M],element:J[I]}}}}return null}j.on("click keyup setContent",function(I){if(I.type=="setcontent"&&!I.selection){return}tinymce.util.Delay.setEditorTimeout(j,function(){var J;J=v(j.selection.getNode());if(J){y();E(J)}else{y()}})});j.on("blur hide",y);j.on("ObjectResizeStart",function(){var I=v(j.selection.getNode());if(I&&I.toolbar.panel){I.toolbar.panel.hide()}});j.on("nodeChange ResizeEditor ResizeWindow",C);j.on("remove",function(){tinymce.each(w(),function(I){if(I.panel){I.panel.remove()}});j.contextToolbars={}});j.shortcuts.add("ctrl+shift+e > ctrl+shift+p","",function(){var I=v(j.selection.getNode());if(I&&I.toolbar.panel){I.toolbar.panel.items()[0].focus()}})}function l(u){return function(){if(u.initialized){u.fire("SkinLoaded")}else{u.on("init",function(){u.fire("SkinLoaded")})}}}function p(u){var x,w;if(t.fixed_toolbar_container){w=h.select(t.fixed_toolbar_container)[0]}function z(){if(x&&x.moveRel&&x.visible()&&!x._fixed){var F=j.selection.getScrollContainer(),B=j.getBody();var D=0,E=0;if(F){var C=h.getPos(B),G=h.getPos(F);D=Math.max(0,G.x-C.x);E=Math.max(0,G.y-C.y)}x.fixed(false).moveRel(B,j.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(D,E)}}function A(){if(x){x.show();z();h.addClass(j.getBody(),"mce-edit-focus")}}function v(){if(x){x.hide();m.hideAll();h.removeClass(j.getBody(),"mce-edit-focus")}}function y(){if(x){if(!x.visible()){A()}return}x=s.panel=k.create({type:w?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:!!w,border:1,items:[t.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:c()},e(t.toolbar_items_size)]});j.fire("BeforeRenderUI");x.renderTo(w||document.body).reflow();a(x);A();b();j.on("nodeChange",z);j.on("activate",A);j.on("deactivate",v);j.nodeChanged()}t.content_editable=true;j.on("focus",function(){if(u.skinUiCss){tinymce.DOM.styleSheetLoader.load(u.skinUiCss,y,y)}else{y()}});j.on("blur hide",v);j.on("remove",function(){if(x){x.remove();x=null}});if(u.skinUiCss){tinymce.DOM.styleSheetLoader.load(u.skinUiCss,l(j))}return{}}function o(u){var v,w,x;function y(){return function(z){if(z.mode=="readonly"){v.find("*").disabled(true)}else{v.find("*").disabled(false)}}}if(u.skinUiCss){tinymce.DOM.styleSheetLoader.load(u.skinUiCss,l(j))}v=s.panel=k.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[t.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:c()},e(t.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]});if(t.resize!==false){w={type:"resizehandle",direction:t.resize,onResizeStart:function(){var z=j.getContentAreaContainer().firstChild;x={width:z.clientWidth,height:z.clientHeight}},onResize:function(z){if(t.resize=="both"){r(x.width+z.deltaX,x.height+z.deltaY)}else{r(null,x.height+z.deltaY)}}}}if(t.statusbar!==false){v.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:true,items:[{type:"elementpath"},w]})}j.fire("BeforeRenderUI");j.on("SwitchMode",y());v.renderBefore(u.targetNode).reflow();if(t.readonly){j.setMode("readonly")}if(t.width){tinymce.DOM.setStyle(v.getEl(),"width",t.width)}j.on("remove",function(){v.remove();v=null});a(v);b();return{iframeContainer:v.find("#iframe")[0].getEl(),editorContainer:v.getEl()}}s.renderUI=function(u){var v=t.skin!==false?t.skin||"lightgray":false;if(v){var w=t.skin_url;if(w){w=j.documentBaseURI.toAbsolute(w)}else{w=tinymce.baseURL+"/skins/"+v}if(tinymce.Env.documentMode<=7){u.skinUiCss=w+"/skin.ie7.min.css"}else{u.skinUiCss=w+"/skin.min.css"}j.contentCSS.push(w+"/content"+(j.inline?".inline":"")+".min.css")}j.on("ProgressState",function(x){s.throbber=s.throbber||new tinymce.ui.Throbber(s.panel.getEl("body"));if(x.state){s.throbber.show(x.time)}else{s.throbber.hide()}});if(t.inline){return p(u)}return o(u)};s.resizeTo=r;s.resizeBy=q});